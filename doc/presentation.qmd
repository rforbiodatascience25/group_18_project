---
title: "Group 18: R for Bio Data Science final project"
author:
  - "Kacper<br>Maciejewski<br>(s243548)"
  - "Sofia<br>Russo<br>(s252054)"
  - "Aleksandra<br>Wozniak<br>(s253713)"
  - "Gabriel<br>Loayza<br>(s252608)"
  - "Dagmar<br>Geevers<br>(s252256)"
format:
  revealjs:
    embed-resources: true
    theme: moon
    slide-number: c/t
    width: 1600
    height: 900
    mainfont: avenir
    logo: images/r4bds_logo_small.png
    footer: "Group 18: R for Bio Data Science final project"
bibliography: references.bib
---

## Introduction

:::: {.columns}

::: {.column width="45%"}

### Epigenetic modifiers HDAC

- **HDAC gene family:** epigenetic modifiers that remove histone acetyl groups and repress gene expression

- **Cancer stemness:** HDACs are often overexpressed in tumors and help maintain cancer stem cells and therapy resistance

- **Immunogenicity:** HDAC activity can reduce antigen presentation and promote an immunosuppressive tumor microenvironment


:::

::: {.column width="55%"}

### HDAC inhibitors

![](https://pub.mdpi-res.com/ddc/ddc-04-00015/article_deploy/html/images/ddc-04-00015-g006.png?1743862479)

HDAC inhibitors can decrease cancer stemness and increase tumor immunogenicity, improving responses to immunotherapy [@Gupta2025].



:::

::::

## Introduction
### Project aim

#### what
Is HDAC gene family expression related to cancer stemness, clinical outcome, and survival?

#### how
By recreating the visualizations and analyses provided in the following study (Figures 2-4), using the same data and our own R implementations. 

> *The Epigenetic Modifiers HDAC2 and HDAC7 Inversely Associate with Cancer Stemness and Immunity in Solid Tumors*, IJMS, [@Maciejewski2024]

#### why
To confirm the correctness of conclusions in the given paper as there is little-to-none literature confirming their findings so far.

## Methods
### Analysis - project overview

:::: {.columns}

::: {.column width="60%"}

```{mermaid}
flowchart TD
  A[cBioPortal] --> B[TCGA clinical data]
  A --> C[TCGA expression data]

  %% Malta et al. before mRNAsi
  X[Malta et al. study] --> D[mRNAsi stemness index]

  %% Data cleanup after B, C, and D
  B --> Bclean[Data cleanup]
  C --> Cclean[Data cleanup]
  D --> Dclean[Data cleanup]

  %% Data merge (data join)
  Bclean --> DM[Data merge]
  Cclean --> DM
  Dclean --> DM

  %% After data merge: data augmentation
  DM --> E[Data augmentation]

  E --> F[Descriptive summary]

  E --> G[Correlation analysis]
  G --> H[mRNAsi]
  G --> I[stage/grade]

  E --> J[Survival modeling]
  J --> K[Overall Survival]
  J --> L[Disease Free Survival]
  
  F --> M[Plots & tables]
  H --> M
  I --> M
  K --> M
  L --> M

  %% Styling: white background, black text
  style A fill:#ffffff,stroke:#000000,color:#000000
  style B fill:#ffffff,stroke:#000000,color:#000000
  style C fill:#ffffff,stroke:#000000,color:#000000
  style X fill:#ffffff,stroke:#000000,color:#000000
  style D fill:#ffffff,stroke:#000000,color:#000000
  style Bclean fill:#ffffff,stroke:#000000,color:#000000
  style Cclean fill:#ffffff,stroke:#000000,color:#000000
  style Dclean fill:#ffffff,stroke:#000000,color:#000000
  style DM fill:#ffffff,stroke:#000000,color:#000000
  style E fill:#ffffff,stroke:#000000,color:#000000
  style F fill:#ffffff,stroke:#000000,color:#000000
  style G fill:#ffffff,stroke:#000000,color:#000000
  style H fill:#ffffff,stroke:#000000,color:#000000
  style I fill:#ffffff,stroke:#000000,color:#000000
  style J fill:#ffffff,stroke:#000000,color:#000000
  style K fill:#ffffff,stroke:#000000,color:#000000
  style L fill:#ffffff,stroke:#000000,color:#000000
  style M fill:#ffffff,stroke:#000000,color:#000000

```

:::

::: {.column width="40%"}

- TCGA expression samples were deduplicated by averaging.
- Spearman correlations with P-value correction for multiple testing (BH method)
- Cox-based risk prediction model with high-low expression (median split) of each HDAC family members.
- On all heatmaps, columns and rows are ordered as original hierarchical clusters.

:::
::::

## Methods
### Data
:::: {.columns}

::: {.column width="50%"}

#### Stemness index (mRNAsi)

downloaded from supplementary materials (Table S1) [@Malta2018]

![](../results/04_key_plot_stemness.png){height=450px}

:::

::: {.column width="50%"}

#### Expression and clinical data

solid tumors selection; data fetched via *cBioPortal* R API [@Cerami2012cBioPortal]


![](../results/04_key_plot_tcga_cohort.png){height=450px}

:::
::::

## Results
### Data distributions

:::: {.columns}
::: {.column width="33%"}

#### HDAC expression across tumors

![](../results/04_key_plot_gene_expression.png)
:::

::: {.column width="33%"}

#### Tumor grade across whole dataset

![](../results/04_key_plot_grade_distribution.png)
:::

::: {.column width="33%"}

#### Cancer stemness and grade

![](../results/04_key_plot_violin.png)
:::

::::

Data distributions are as expected with main HDAC genes expression medians on similar levels. Grade and stage (not shown) statuses represent normal-like distributions.

## Results

:::: {.columns}
::: {.column width="40%"}

### HDAC expression vs grade

![](../results/05_heatmap_for_grade.png){height=500px}

:::

::: {.column width="40%"}

### HDAC expression vs stage

![](../results/05_heatmap_for_stage.png){height=500px}

:::

::: {.column width="20%"}

```{mermaid}
flowchart TD
  A[pivot_longer] --> B[group_by<br/>by 'cancer' and 'gene']
  B --> C[Spearman]
  C --> D[pivot_wider]
  D --> E[Benjamini Hochberg correction]
  E --> F[annotations and heatmap]
  
classDef whiteNode fill:#ffffff,stroke:#000000,color:#000000;
class A,B,C,D,E,F whiteNode;
```

:::
::::

The expression of HDAC family members is sssociated with clinicopathological features of TCGA solid tumors in a cancer-dependent and gene-specific manner.

## Results
### HDAC family expression is associted with survival

:::: {.columns}
::: {.column width="40%"}

![](../results/07_plot_Disease_Free_Survival.png)

:::

::: {.column width="40%"}

![](../results/07_plot_Overall_Survival.png)
:::

::: {.column width="20%"}

```{mermaid}
flowchart TD
  A[standardize expression<br/>& convert status to numerical] --> B[split by cancer]
  B --> D[Cox model<br/>HR & p-values]
  D --> E[create matrices<br/>& reshape to long format]
  E --> G[heatmap and annotation]
  
classDef whiteNode fill:#ffffff,stroke:#000000,color:#000000;
class A,B,C,D,E,F,G,H whiteNode;
```

:::
::::

HDAC gene expression does not show consistent behaviour within HDAC classes. The prognostic relevance is highly tumor-dependent but still present.

## Results
### HDAC family expression vs cancer stemness


:::: {.columns}
::: {.column width="50%"}

- Class I HDAC family members correlate positively, while class IIA HDAC genes correlate negatively with cancer stemness across TCGA solid tumors.
- Specifically, HDAC2 (member of class I) and HDAC7 (member of class IIA) genes show the highest correlations across studied solid tumors, exhibiting statistically significant opposite trends

:::

::: {.column width="50%"}

![](../results/06_Heatmap_Stemness.png)

:::
::::

## Discussion
### Inverse association with cancer stemness and immunogenicity

- This project confirmed a strong, tumor-typeâ€“independent association between cancer stemness and elevated class I HDAC expression, especially HDAC2, while class IIA HDACs showed the opposite trend, with HDAC7 most strongly negatively associated.
- Since cancer stemness and immune infiltration are inversely related [@Malta2018], patients with stem-like, poorly infiltrated tumors and high HDAC2 expression may benefit from combining HDAC2-selective inhibitors with immunotherapy.

### Replication crisis

Although the so-called *replication crisis* in biomedical research is real [@Ioannidis2005], we reproduced the key findings with only minor differences. This is a major success, given the lack of published code, the need to infer minor preprocessing steps, and the fact that we recomputed survival from raw data rather than using existing database results.


## Discussion
### Technical take aways

- **We successful managed to recreate expected figures and managed to derive exactly the same results and conclusions.**
- In our future project we should use `try(..., silent=TRUE)` with higher caution as it made it hard for us to debug.

### Further steps and improvements

- Confirming the relation of HDAC and immunological inflamation which was included in the reproduced paper but outside of the scope of this project.
- Plotting function could have been shared across all figures to deliver the same aesthetics.
- `pheatmap` or `complexheatmap` would create better-looking plots with recomputed clusterings but we wanted to be 100% aligned with the course content.

## References

::: references
:::
